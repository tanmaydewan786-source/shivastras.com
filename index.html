<!-- index.html
     Final production-grade page for Shivastras
     - Gallery includes gallery3.jpeg (your corrected ring image)
     - Full survey with consent, popup game, analytics
     - Replace Formspree action with your endpoint before publishing
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shivastras ‚Äî Wear your calm. Carry your power.</title>

  <!-- Prevent caching while iterating -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- SEO -->
  <meta name="description" content="Shivastras ‚Äî a dark-luxury ring: obsidian core, modern precision. Sign up for early interest and win the first ring." />

  <!-- Fonts: UI + brand (ancient serif) -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Plausible analytics (provided) -->
  <script async src="https://plausible.io/js/pa-0IUKSZSYLEBpEEp-dKNxj.js"></script>
  <script>
    window.plausible = window.plausible || function(){(plausible.q = plausible.q || []).push(arguments)};
    plausible.init = plausible.init || function(i){plausible.o = i || {}};
    plausible.init();
  </script>

  <!-- Styles: explicit and verbose for clarity -->
  <style>
    /********* Design tokens *********/
    :root{
      --bg-1: #03030a;
      --bg-2: #070713;
      --muted: #9aa3ad;
      --text: #f7fafc;
      --accent: #3b82f6;
      --accent-soft: rgba(59,130,246,0.18);
      --glass: rgba(255,255,255,0.03);
      --radius-xl: 28px;
      --radius-lg: 12px;
      --max-width: 1200px;
      --header-height: 76px;
    }

    /* ---------- base ---------- */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font-family: Inter, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      color: var(--text);
      background: radial-gradient(circle at 10% 10%, #0b1220 0%, #02010a 45%, #000 100%);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height: 1.6;
      overflow-x: hidden;
      scroll-behavior: smooth;
    }
    .container { max-width: var(--max-width); margin: 0 auto; padding: 0 22px; }

    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; height: auto; display: block; }

    /* ---------- header ---------- */
    header.site-header {
      position: fixed;
      left: 0; right: 0; top: 0;
      height: var(--header-height);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 22px;
      z-index: 1600;
      background: linear-gradient(180deg, rgba(0,0,0,0.56), rgba(0,0,0,0.12));
      border-bottom: 1px solid rgba(255,255,255,0.02);
      backdrop-filter: blur(12px);
    }
    .brand {
      font-family: "Cormorant Garamond", serif;
      font-weight: 700;
      font-size: 1.12rem;
      letter-spacing: .04em;
      text-transform: capitalize; /* Shivastras */
    }
    nav.main-nav a {
      margin-left: 18px;
      color: var(--muted);
      font-size: .95rem;
      text-transform: capitalize;
      transition: color .18s ease, transform .18s ease;
    }
    nav.main-nav a:hover { color: var(--text); transform: translateY(-1px); }

    /* ---------- intro overlay / preloader ---------- */
    #intro {
      position: fixed; inset: 0; display:flex; align-items:center; justify-content:center;
      background: #000; z-index: 4000; transition: opacity .8s ease, visibility .8s;
    }
    #intro.hidden { opacity: 0; visibility: hidden; }
    #intro .label {
      font-family: "Cormorant Garamond", serif;
      color: #e9eef7;
      letter-spacing: .3em;
      text-transform: uppercase;
      font-size: .95rem;
    }

    /* ---------- hero: centered ---------- */
    .hero {
      min-height: calc(100vh - var(--header-height));
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 36px;
      align-items: center; /* centered vertically */
      padding: 110px 0 80px; /* top space to account for fixed header */
    }
    @media (max-width: 980px) {
      .hero { grid-template-columns: 1fr; padding-top: 140px; gap: 24px; }
    }
    .hero-left { align-self: center; }
    .eyebrow { color: var(--accent); font-weight: 600; letter-spacing: .24em; text-transform: capitalize; margin-bottom: 8px; font-size: .78rem; }
    .hero-title {
      font-family: "Cormorant Garamond", serif;
      font-weight: 700;
      margin: 6px 0 12px;
      font-size: clamp(2.2rem, 5vw, 3.6rem);
      line-height: 1.02;
      text-transform: capitalize;
    }
    .hero-sub { color: var(--muted); max-width: 620px; font-size: 1rem; margin-bottom: 16px; }
    .cta-row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:8px; }
    .btn {
      padding: 12px 26px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.04);
      cursor:pointer;
      font-weight:700;
      text-transform: capitalize;
      background: transparent;
      color: var(--text);
    }
    .btn-primary { background: var(--accent); border-color: transparent; color: #fff; box-shadow: 0 10px 40px rgba(59,130,246,0.12); }

    .hero-meta { margin-top: 16px; color: var(--muted); font-size: .92rem; text-transform: capitalize; }

    /* ---------- visual card ---------- */
    .hero-right { display:flex; align-items:center; justify-content:center; position:relative; }
    .halo {
      position:absolute; width:360px; height:360px; border-radius:999px; z-index:0;
      background: radial-gradient(circle, rgba(59,130,246,0.32), transparent 60%);
      filter: blur(14px); transform: translateY(8px);
      animation: haloPulse 5s ease-in-out infinite;
      pointer-events: none;
    }
    @keyframes haloPulse { 0%,100%{ transform: translateY(8px) scale(1); opacity: 0.95 } 50%{ transform: translateY(14px) scale(1.06); opacity: 0.45 } }

    .visual-card {
      width: 480px; max-width: 92%;
      border-radius: var(--radius-xl);
      padding: 20px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      box-shadow: 0 30px 120px rgba(0,0,0,0.8), 0 0 100px var(--accent-soft);
      transition: transform .45s cubic-bezier(.2,.9,.3,1);
    }
    .visual-card:hover { transform: translateY(-8px) rotate3d(0.02,-0.02,0,3.8deg); }
    .visual-frame { border-radius: 18px; overflow:hidden; background: linear-gradient(120deg,#06060a,#0c0d12); }
    .visual-frame img { width: 100%; height: auto; display:block; }

    .visual-caption { position:absolute; left:24px; bottom:20px; font-size:0.82rem; color:var(--muted); }

    /* ---------- content sections ---------- */
    section { padding: 64px 0; }
    .story { padding-top: 38px; }

    .two-col { display:grid; grid-template-columns: 1fr 1fr; gap: 28px; align-items: center; }
    @media (max-width: 940px) { .two-col { grid-template-columns: 1fr; } }

    .panel {
      padding: 20px; border-radius: 12px; background: rgba(255,255,255,0.015); border: 1px solid rgba(255,255,255,0.03);
    }

    .feature { display:flex; gap:12px; margin-bottom:12px; align-items:flex-start; }
    .feature .icon { width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:#07070d; border:1px solid rgba(255,255,255,0.03); }

    /* ---------- gallery ---------- */
    .gallery { display:grid; grid-template-columns: repeat(3, 1fr); gap: 18px; margin-top: 18px; }
    @media (max-width: 940px) { .gallery { grid-template-columns: 1fr; } }
    .gallery img { width:100%; height: 320px; object-fit: cover; border-radius: 12px; filter: brightness(.96); transition: transform .35s, filter .35s; }
    .gallery img:hover { transform: translateY(-6px); filter: brightness(1.12); }

    /* ---------- survey (responsive, polished) ---------- */
    .survey-wrap {
      max-width: 920px; margin: 0 auto; padding: 28px;
      border-radius: 14px; background: linear-gradient(135deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));
      border: 1px solid rgba(255,255,255,0.03); box-shadow: 0 20px 80px rgba(0,0,0,0.75);
    }
    .survey-grid { display:grid; gap:12px; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    @media (max-width: 720px) { .row { grid-template-columns: 1fr; } }

    input, select, textarea {
      width:100%;
      padding: 12px 14px; border-radius: 10px;
      border:1px solid rgba(255,255,255,0.04); background: rgba(10,12,15,0.6);
      color: var(--text); font-size: .95rem;
    }
    textarea { min-height: 120px; resize: vertical; }

    .consent { display:flex; gap:8px; align-items:flex-start; margin-top:10px; color: var(--muted); font-size: .95rem; }
    .consent a { color: var(--accent); text-decoration: underline; }

    /* ---------- popup game ---------- */
    #gameModal {
      position: fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.9));
      z-index: 3500; visibility: hidden; opacity: 0; transition: opacity .28s ease, visibility .28s ease;
    }
    #gameModal.active { visibility: visible; opacity: 1; }
    .game-card {
      width: 560px; max-width: 96%; padding: 22px; border-radius: 16px;
      background: linear-gradient(180deg, #05060a, #0b0d12);
      border: 1px solid rgba(255,255,255,0.03); box-shadow: 0 40px 140px rgba(0,0,0,0.85);
      text-align: center;
    }
    .game-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
    .game-instructions { color: var(--muted); margin-bottom:10px; }
    .energy-area { position:relative; height:360px; border-radius: 12px; overflow:hidden; display:flex; align-items:center; justify-content:center; border: 1px solid rgba(255,255,255,0.02); background: linear-gradient(180deg,#06060a,#0b0d12); }
    .energy-core { width:160px; height:160px; border-radius:999px; background: radial-gradient(circle at 35% 30%, rgba(255,255,255,0.06), rgba(59,130,246,0.5) 30%, rgba(12,22,44,0.6) 100%); box-shadow: 0 12px 48px rgba(59,130,246,0.18), 0 0 140px rgba(59,130,246,0.12); transition: transform .08s, box-shadow .08s; }

    /* cursor aura */
    .cursor-aura {
      position: fixed; pointer-events:none; z-index:5000; width:48px; height:48px;
      border-radius:999px; transform: translate(-50%,-50%); transition: width .06s linear, height .06s linear, opacity .12s;
      background: radial-gradient(circle at 30% 30%, rgba(59,130,246,0.95), rgba(59,130,246,0.25) 40%, rgba(59,130,246,0.06) 70%, transparent 100%);
      mix-blend-mode: screen; filter: blur(6px); opacity: 0.9;
    }
    @media (max-width:720px) { .cursor-aura { display:none; } }

    /* ---------- small helpers ---------- */
    .muted { color: var(--muted); }
    .center { text-align:center; }
    .visible { opacity:1; transform:none; transition: all .6s ease; }

    footer { padding: 36px 0; text-align:center; color: var(--muted); border-top: 1px solid rgba(255,255,255,0.02); margin-top: 30px; }
  </style>
</head>
<body>

  <!-- intro overlay -->
  <div id="intro"><div class="label">shivastras</div></div>

  <!-- cursor aura for desktop -->
  <div id="cursorAura" class="cursor-aura" aria-hidden="true"></div>

  <!-- header -->
  <header class="site-header container" role="banner">
    <div class="brand">Shivastras</div>
    <nav class="main-nav" aria-label="Main navigation">
      <a href="#about">About</a>
      <a href="#gallery">Gallery</a>
      <a href="#story">Story</a>
      <a href="#survey">Survey</a>
    </nav>
  </header>

  <main>

    <!-- HERO -->
    <section class="hero container" id="heroSection" role="region" aria-label="Hero">
      <div class="hero-left">
        <div class="eyebrow">Divine power ¬∑ modern artifact</div>
        <h1 class="hero-title">Wear your calm. Carry your power.</h1>
        <p class="hero-sub">A dark-luxury ring crafted from sacred geometry, gemstone resonance and modern precision. Designed to be a daily anchor ‚Äî a reminder to return to focus.</p>

        <div class="cta-row">
          <button class="btn btn-primary" onclick="document.getElementById('survey').scrollIntoView({behavior:'smooth'})">Take the survey</button>
          <button class="btn" onclick="openGameModal()">Experience aura</button>
        </div>

        <div class="hero-meta">coming soon</div>
      </div>

      <div class="hero-right" aria-hidden="false">
        <div class="halo" aria-hidden="true" style="right:6%; top:10%"></div>
        <div class="visual-card" id="visualCard">
          <div class="visual-frame">
            <img id="heroImage" src="assets/images/hero.jpg" alt="Shivastras ring hero">
          </div>
          <div class="visual-caption">Shivastras ‚Äî obsidian blue</div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="container story" aria-labelledby="aboutHeading">
      <div class="two-col">
        <div>
          <h2 id="aboutHeading">What is Shivastras</h2>
          <p class="muted">Not a gadget. Not a trend. A wearable object that invites small, daily pauses ‚Äî bringing attention back to what matters.</p>

          <div style="margin-top:18px"></div>

          <div class="feature">
            <div class="icon" aria-hidden="true">üî∑</div>
            <div>
              <h4 style="margin:0">Grounding gemstone core</h4>
              <p class="muted" style="margin-top:6px">A carefully chosen obsidian node tuned for clarity and presence.</p>
            </div>
          </div>

          <div class="feature">
            <div class="icon" aria-hidden="true">‚öôÔ∏è</div>
            <div>
              <h4 style="margin:0">Precision craft</h4>
              <p class="muted" style="margin-top:6px">Balanced weight and comfortable daily wear, finished in matte black metal and a polished gemstone inset.</p>
            </div>
          </div>
        </div>

        <div class="panel" aria-hidden="false">
          <h3 style="margin-top:0">How it works</h3>
          <p class="muted">This is a designed experience: small tactile triggers and symbolic geometry act as a persistent reminder for attention and calm.</p>

          <div class="specs" style="margin-top:12px;">
            <div class="panel"><strong>Core</strong><div class="muted">Obsidian blue</div></div>
            <div class="panel"><strong>Metal</strong><div class="muted">Matte black precision alloy</div></div>
            <div class="panel"><strong>Finish</strong><div class="muted">Satin / polished options</div></div>
            <div class="panel"><strong>Edition</strong><div class="muted">First series</div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- GALLERY (final: includes gallery3.jpeg) -->
    <section id="gallery" class="container" aria-labelledby="galleryHeading" style="padding-top:36px;">
      <h2 id="galleryHeading" class="center" style="font-family:'Cormorant Garamond',serif; font-size:1.8rem;">Gallery</h2>
      <p class="center muted" style="margin-top:6px;">Shivastras in shadow, metal and light</p>

      <div class="gallery" aria-hidden="false">
        <img src="assets/images/gallery1.jpg" alt="Shivastras gallery angle view">
        <img src="assets/images/gallery2.jpg" alt="Shivastras lifestyle view">
        <!-- FINAL corrected ring image you will upload -->
        <img src="assets/images/gallery3.jpeg" alt="Shivastras corrected ring - close up">
      </div>
    </section>

    <!-- STORY -->
    <section class="container story" style="padding-top:48px;">
      <div class="two-col">
        <div class="panel">
          <h3 style="margin-top:0">Wearing the ring</h3>
          <p class="muted">Use it as a micro ritual: three slow breaths, touch the ring, and return to the present. Over time, this small practice becomes a stable anchor in daily life.</p>
        </div>

        <div>
          <h3>Design notes</h3>
          <p class="muted">Subtle trishula-inspired geometry, a hidden inner mark on the band, and a balance between presence and discretion.</p>
        </div>
      </div>
    </section>

    <!-- SURVEY (full responsive) -->
    <section id="survey" class="container" style="padding-top:56px;padding-bottom:80px;">
      <div class="survey-wrap" role="form" aria-labelledby="surveyHeading">
        <div class="center" style="margin-bottom:12px;">
          <div class="caps muted">Customer interest survey</div>
          <h2 id="surveyHeading" style="margin:8px 0 6px; font-family:'Cormorant Garamond',serif">Take the survey</h2>
          <p class="muted" style="font-size:.95rem">Take the survey and stand a chance to win the first Shivastras ring.</p>
        </div>

        <!-- NOTE: replace action with your real Formspree endpoint -->
        <form id="surveyForm" action="https://formspree.io/f/YOUR-FORM-ID" method="POST" class="survey-grid" novalidate>
          <div class="row">
            <input name="name" type="text" placeholder="Full name" required aria-label="Full name">
            <input name="email" type="email" placeholder="Email address" required aria-label="Email address">
          </div>

          <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:12px;">
            <select name="would_buy" required aria-label="Would you consider buying">
              <option value="" disabled selected>Would you consider buying?</option>
              <option>Yes - definitely</option>
              <option>Maybe - curious</option>
              <option>No - not for me</option>
            </select>

            <select name="expected_price" required aria-label="What price would you expect">
              <option value="" disabled selected>What price would you expect?</option>
              <option>‚Çπ999 ‚Äì ‚Çπ1499</option>
              <option>‚Çπ1499 ‚Äì ‚Çπ1999</option>
              <option>‚Çπ1999 ‚Äì ‚Çπ2999</option>
              <option>‚Çπ3000+</option>
            </select>
          </div>

          <div style="margin-top:12px;">
            <label class="muted" style="display:block;margin-bottom:6px;">What would you use this ring for?</label>
            <select name="use_case" required aria-label="Primary use">
              <option value="" disabled selected>Select primary use</option>
              <option>Daily ritual / mindfulness</option>
              <option>Style / fashion</option>
              <option>Gift</option>
              <option>Other</option>
            </select>
          </div>

          <div style="margin-top:12px;">
            <label class="muted" style="display:block;margin-bottom:6px;">Features you'd like</label>
            <textarea name="features" placeholder="Features you'd like to see (materials, finishes, sizes, etc.)" aria-label="Features you'd like"></textarea>
          </div>

          <div style="margin-top:12px;">
            <label class="muted" style="display:block;margin-bottom:6px;">Why does this idea interest you?</label>
            <textarea name="why" placeholder="Briefly tell us why" aria-label="Why does this idea interest you"></textarea>
          </div>

          <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:12px;">
            <select name="ring_size" aria-label="Ring size">
              <option value="" disabled selected>Ring size (optional)</option>
              <option>7</option><option>8</option><option>9</option><option>10</option>
            </select>
            <input name="heard_from" type="text" placeholder="Where did you hear about us? (Instagram / Friend)" aria-label="Where did you hear about us">
          </div>

          <!-- Consent - required -->
          <div class="consent" style="margin-top:12px;">
            <input type="checkbox" id="consentCheckbox" name="consent" value="agreed" required aria-required="true" />
            <label for="consentCheckbox">I agree to the <a href="terms.html" target="_blank" rel="noopener">terms and conditions</a> and consent to receive communication from Shivastras via email or WhatsApp.</label>
          </div>

          <div style="margin-top:14px; display:flex; gap:12px; align-items:center; flex-wrap:wrap;">
            <button type="submit" class="btn btn-primary">Submit</button>
            <div class="muted" style="font-size:.9rem">We use responses for research and product development only</div>
          </div>
        </form>
      </div>
    </section>

    <!-- GAME POPUP (experience aura) -->
    <div id="gameModal" aria-hidden="true" role="dialog" aria-label="Experience aura">
      <div class="game-card" role="document" aria-live="polite">
        <div class="game-top">
          <div>
            <div style="font-size:.82rem;color:var(--muted);text-transform:capitalize">Experience aura</div>
            <h3 style="margin:6px 0 0; font-family:'Cormorant Garamond',serif">Stabilize the core</h3>
          </div>
          <button id="closeGameBtn" aria-label="Close" style="background:transparent;border:none;color:var(--muted);font-size:20px;cursor:pointer">‚úï</button>
        </div>

        <div class="game-instructions muted">Move your cursor or touch near the core ‚Äî the aura intensifies. Tap the core when the glow peaks to stabilize energy.</div>

        <div class="energy-area" id="energyArea">
          <div class="energy-core" id="energyCore" role="button" aria-label="energy core" tabindex="0"></div>
        </div>

        <div style="margin-top:12px;color:var(--muted)">Energy stabilized: <span id="auraScore">0</span></div>

        <div style="margin-top:12px; display:flex; gap:10px; justify-content:center;">
          <button class="btn" onclick="closeGameModal()">Close</button>
        </div>
      </div>
    </div>

  </main>

  <footer>
    ¬© 2025 Shivastras ‚Äî a modern artifact of presence
  </footer>

  <!-- ---------- Scripts: interactions & logic ---------- -->
  <script>
    /***** Preloader hide ********/
    window.addEventListener('load', () => {
      setTimeout(() => document.getElementById('intro').classList.add('hidden'), 260);
    });

    /***** Reveal on scroll (light) *******/
    (function(){
      const revealEls = document.querySelectorAll('.reveal');
      if (!('IntersectionObserver' in window)) {
        revealEls.forEach(el => el.classList.add('visible'));
        return;
      }
      const obs = new IntersectionObserver((entries, o) => {
        entries.forEach(e => {
          if (e.isIntersecting) {
            e.target.classList.add('visible');
            o.unobserve(e.target);
          }
        });
      }, { threshold: 0.12 });
      document.querySelectorAll('.reveal').forEach(n => obs.observe(n));
    })();

    /***** Hero micro parallax & card tilt ******/
    (function(){
      const heroImage = document.getElementById('heroImage');
      const visualCard = document.getElementById('visualCard');
      if (heroImage && visualCard) {
        window.addEventListener('scroll', () => {
          const sc = window.scrollY || window.pageYOffset;
          heroImage.style.transform = `translateY(${sc * 0.03}px)`;
        });

        visualCard.addEventListener('mousemove', (ev) => {
          const r = visualCard.getBoundingClientRect();
          const dx = (ev.clientX - r.left) / r.width - 0.5;
          const dy = (ev.clientY - r.top) / r.height - 0.5;
          visualCard.style.transform = `rotateX(${dy * 5}deg) rotateY(${dx * -6}deg) translateZ(0)`;
        });
        visualCard.addEventListener('mouseleave', () => visualCard.style.transform = '');
      }
    })();

    /***** Cursor aura: hybrid (desktop + mobile touch) ******/
    (function(){
      const aura = document.getElementById('cursorAura');
      let mouseX = window.innerWidth/2, mouseY = window.innerHeight/2;
      let lastMove = Date.now();

      // Desktop: follow mouse
      window.addEventListener('mousemove', (e) => {
        mouseX = e.clientX; mouseY = e.clientY;
        aura.style.left = mouseX + 'px'; aura.style.top = mouseY + 'px';
        aura.style.opacity = '0.95';
        lastMove = Date.now();
      });

      // Mobile: follow first touch
      window.addEventListener('touchmove', (e) => {
        const t = e.touches[0];
        if (!t) return;
        mouseX = t.clientX; mouseY = t.clientY;
        aura.style.left = mouseX + 'px'; aura.style.top = mouseY + 'px';
        aura.style.opacity = '0.95';
      }, { passive: true });

      // fade aura when idle
      setInterval(() => {
        if (Date.now() - lastMove > 2200) aura.style.opacity = '0.45';
      }, 800);

      // proximity mapping relative to energy core
      function updateProximity() {
        const core = document.getElementById('energyCore');
        if (!core) return;
        const rect = core.getBoundingClientRect();
        const cx = rect.left + rect.width/2;
        const cy = rect.top + rect.height/2;
        const dx = mouseX - cx, dy = mouseY - cy;
        const dist = Math.sqrt(dx*dx + dy*dy);
        const max = Math.max(window.innerWidth, window.innerHeight);
        const normalized = Math.max(0, 1 - (dist / (max * 0.35))); // 0..1

        const auraSize = 48 + (normalized * 160);
        aura.style.width = auraSize + 'px';
        aura.style.height = auraSize + 'px';
        aura.style.filter = `blur(${6 - normalized * 4}px)`;
        aura.style.opacity = (0.4 + normalized * 0.7).toFixed(2);

        // core glow intensity
        const coreEl = core;
        const coreScale = 1 + normalized * 0.5;
        coreEl.style.transform = `scale(${coreScale})`;
        coreEl.style.boxShadow = `0 12px ${24 + normalized*80}px rgba(59,130,246,${0.12 + normalized*0.45}), 0 0 ${60 + normalized*220}px rgba(59,130,246,${0.08 + normalized*0.35})`;
      }

      window.addEventListener('mousemove', updateProximity);
      window.addEventListener('touchmove', (e) => { const t = e.touches[0]; if (t) { mouseX = t.clientX; mouseY = t.clientY; updateProximity(); } }, { passive: true });
      setInterval(updateProximity, 60);
    })();

    /***** Game modal logic (desktop + mobile touch playable) ******/
    (function(){
      const modal = document.getElementById('gameModal');
      const core = document.getElementById('energyCore');
      const scoreNode = document.getElementById('auraScore');
      const closeBtn = document.getElementById('closeGameBtn');
      let score = 0;
      let active = false;

      window.openGameModal = function(){
        modal.classList.add('active');
        modal.setAttribute('aria-hidden','false');
        active = true;
      };
      window.closeGameModal = function(){
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden','true');
        active = false;
      };

      // Auto open once per page load (user can close)
      setTimeout(() => { window.openGameModal(); }, 11000);

      // increase score when core tapped/clicked
      function activateCore(){
        if (!active) return;
        score++;
        scoreNode.textContent = score;
        core.style.transform = 'scale(0.95)';
        setTimeout(()=> core.style.transform = '', 120);
      }

      core.addEventListener('click', activateCore);
      core.addEventListener('touchstart', (e) => { activateCore(); e.preventDefault(); }, { passive: false });

      closeBtn.addEventListener('click', () => window.closeGameModal());
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') window.closeGameModal(); });
    })();

    /***** Survey UI: lightweight confirmation (Formspree does submission) ******/
    (function(){
      const form = document.getElementById('surveyForm');
      if (!form) return;
      form.addEventListener('submit', function(e){
        // Allow network to send; show user feedback after a short delay
        setTimeout(()=> {
          try { alert('Thank you ‚Äî your answers were submitted.'); } catch(err) {}
        }, 700);
      });
    })();
  </script>

  <!-- End of page -->
</body>
</html>
